{% extends "mbm/base.html" %}
{% load leaflet_tags %}
{% load static %}

{% block title %}{{ view.title }}{% endblock %}

{% block extra_css %}
  {% leaflet_css %}
  <link rel="stylesheet" href="{% static 'css/spin.css' %}" />
{% endblock %}

{% block body %}
  <div class="row">
    <div id="controls-container" class="col-12 col-md-3">
      <div class="container-fluid m-auto form-group">
        <form id="input-elements" class="hideable collapse multi-collapse">
          <label for="source_text">Start address</label>
          <input id="source_text" class="form-control my-2" name="source_text" placeholder="Start address" value="My position"></input>
          <input id="source" name="source_text" hidden="true"></input>
          <label for="target_text">End address</label>
          <input id="target_text" class="form-control my-2" name="target_text" placeholder="End address"></input>
          <input id="target" name="target" hidden="true"></input>
          <button id="submit" type="submit" class="btn btn-primary btn-block mt-1">Search</button>
          <button id="reset-search" type="reset" class="btn btn-secondary btn-block mb-2">Reset search</button>
          <div>
              <input type="checkbox" id="enable-v2" name="enable-v2" />
              <label for="enable-v2" style="padding-left: 5px">Use v2 routing</label>
              <i
                data-toggle="tooltip"
                data-placement="top"
                title="V2 routing uses a new experimental algorithm that considers all residential streets to be mellow streets."
                style="cursor: pointer"
              >
                <i class="fa fa-fw fa-info-circle text-muted"></i>
              </i>
          </div>
          <span id="route-estimate" class="text-muted"></span>
        </form>
        <button
          id="hide"
          class="btn btn-outline-secondary mb-2"
          type="button"
          data-toggle="collapse"
          href=".hideable"
          role="button"
          aria-expanded="true"
          aria-controls="input-elements navbar-tagline"
          data-state="hidden"
        >
          &or; Search for a route
        </button>
        <button
          id="hide-legend"
          class="btn btn-outline-secondary mb-2"
          type="button"
          role="button"
          aria-expanded="true"
          aria-controls="hideable-legend"
          data-state="shown"
        >
          &and; Hide legend
        </button>
      </div>
    </div>
    <div class="col-12 col-md-9">
      <div id="map"></div>
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  {% leaflet_js %}
  <script type="text/javascript" src="{% static 'js/leaflet-google.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/spin.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/leaflet.spin.min.js' %}"></script>
  <script
    type="text/javascript"
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvdUtVFRDt4QG1AcU7Vt3N1SULbxri44M&libraries=places"
  >
  </script>
  <script type="text/javascript">
    context = {
      routeListUrl: "{% url 'route-list' %}",
      routeUrl: "{% url 'route' %}"
    }
  </script>
  <script type="module" src="{% static 'js/app.js' %}"></script>
{% endblock %}
